shard_size = (index_num + nshards - 1) // nshards